import Foundation
import ProjectDescription
import TSCBasic
import TuistCore
import TuistGraph
import TuistSupport
import XCTest

@testable import TuistLoader
@testable import TuistSupportTesting

final class ShowNonLocalizedStringsMapperTests: TuistUnitTestCase {
    private typealias Manifest = ProjectDescription.Workspace.GenerationOptions.AutogeneratedWorkspaceSchemes

    func test_from_returnsTheCorrectValue_whenShowNonLocalizedStringsIsFalse() throws {
        // Given
        let temporaryPath = try temporaryPath()
        let generatorPaths = GeneratorPaths(manifestDirectory: temporaryPath)
        let manifest = Manifest.enabled(showNonLocalizedStrings: false)

        // When
        let got = try TuistGraph.Workspace.GenerationOptions.AutogeneratedWorkspaceSchemes.from(
            manifest: manifest,
            generatorPaths: generatorPaths
        )

        // Then
        XCTAssertEqual(false, got.showNonLocalizedStrings)
    }

    func test_from_returnsTheCorrectValue_whenShowNonLocalizedStringsIsTrue() throws {
        // Given
        let temporaryPath = try temporaryPath()
        let generatorPaths = GeneratorPaths(manifestDirectory: temporaryPath)
        let manifest = Manifest.enabled(showNonLocalizedStrings: true)

        // When
        let got = try TuistGraph.Workspace.GenerationOptions.AutogeneratedWorkspaceSchemes.from(
            manifest: manifest,
            generatorPaths: generatorPaths
        )

        // Then
        XCTAssertEqual(true, got.showNonLocalizedStrings)
    }

    func test_from_returnsTheCorrectValue_whenShowNonLocalizedStringsIsNotSpecified() throws {
        // Given
        let temporaryPath = try temporaryPath()
        let generatorPaths = GeneratorPaths(manifestDirectory: temporaryPath)
        let manifest = Manifest.enabled()

        // When
        let got = try TuistGraph.Workspace.GenerationOptions.AutogeneratedWorkspaceSchemes.from(
            manifest: manifest,
            generatorPaths: generatorPaths
        )

        // Then
        XCTAssertEqual(false, got.showNonLocalizedStrings)
    }
}
